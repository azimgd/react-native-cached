var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.checkLocalImage=exports.getFilename=exports.getPriority=exports.generateSignature=exports.getIsRemote=exports.getPartial=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _reactNativeFs=_interopRequireDefault(require("react-native-fs"));var cyrb53=function cyrb53(str){var seed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var h1=0xdeadbeef^seed,h2=0x41c6ce57^seed;for(var i=0,ch;i<str.length;i++){ch=str.charCodeAt(i);h1=Math.imul(h1^ch,2654435761);h2=Math.imul(h2^ch,1597334677);}h1=Math.imul(h1^h1>>>16,2246822507)^Math.imul(h2^h2>>>13,3266489909);h2=Math.imul(h2^h2>>>16,2246822507)^Math.imul(h1^h1>>>13,3266489909);return 4294967296*(2097151&h2)+(h1>>>0);};var getPartial=function getPartial(source){return cyrb53(source);};exports.getPartial=getPartial;var getIsRemote=function getIsRemote(source){return source.includes('http://')||source.includes('https://');};exports.getIsRemote=getIsRemote;var generateSignature=function generateSignature(source){if(typeof source!=='string'||!source.length){return{partial:'',path:'',isRemote:''};}var isRemote=getIsRemote(source);var partial=getPartial(source);var path=isRemote?_reactNativeFs.default.CachesDirectoryPath+"/ACME/"+partial+".jpg":source;var pathFolder=path.substring(0,path.lastIndexOf('/'));return{source:source,partial:partial,path:path,pathFolder:pathFolder,isRemote:isRemote};};exports.generateSignature=generateSignature;var getPriority=function getPriority(){var filename=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var priority=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(filename.includes('64p')){return priority;}if(filename.includes('480p')){return 1000+priority;}if(filename.includes('4K')){return 10000+priority;}if(filename.includes('native')){return 100000+priority;}return 0;};exports.getPriority=getPriority;var getFilename=function getFilename(source){if(!source)return'';var withoutQuery=source.split('?').shift();var withoutPath=withoutQuery.split('/').pop();var withoutExt=withoutPath.split('.').shift();return withoutExt;};exports.getFilename=getFilename;var checkLocalImage=function checkLocalImage(path){return _regenerator.default.async(function checkLocalImage$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator.default.awrap(_reactNativeFs.default.exists(path));case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop();}}},null,null,null,Promise);};exports.checkLocalImage=checkLocalImage;